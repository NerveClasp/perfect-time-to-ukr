<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="bower_components/polymerfire/firebase-query.html">
<link rel="import" href="bower_components/paper-input/paper-input.html">
<link rel="import" href="bower_components/paper-input/paper-textarea.html">
<link rel="import" href="bower_components/paper-card/paper-card.html">
<link rel="import" href="bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="stylesheet" href="style.css" media="screen" title="no title">

<dom-module id="tweets-list" path="">
<style is="custom-style" include="iron-flex">
.container {
  @apply(--layout-horizontal);
  @apply(--layout-wrap);

}
.list-container{
  font-size: 10pt;
  @apply(--layout-horizontal);
  margin: 3px;
  width: 100%;
  align-self: center;
}
@media only screen and (min-width: 768px) {
  .list-container{
    font-size: 14pt;
    max-width: 768px;
  }
}
.text{
  @apply(--layout-flex);
}
.pcard{
  @apply(--layout-flex);
  /*@apply(--layout-vertical);*/
  align-items: center;
}
/*.tweet-text{
  display:block;
  vertical-align: middle;
  padding: 5px 0 0 1.28em;
  width: 100%;
  font-family: Comfortaa, sans-serif;

}*/
#name{
  padding: 0;
}
/*.userpic{
  border-radius: 50%;
  background-position: center center;
  margin-left: 1.28em;
}
.userpic-container{
  width: 5.14em;
  height: 2.57em;
  min-width: 2.57em;
  align-self: center;
  padding-left: 5px;
  padding-right: 0.57em;
  border-radius: 3px;
  margin: 0.29em;
}*/
.info{
  @apply(--layout-horizontal);
  color: #3a5d7e;
  text-align: left;
  padding-left: 48px;
  width: 100%;
  font-family: OpenGostB, monospace;
}
.info-details{
  @apply(--layout-flex);
  padding-right: 12px;
  align-self: center;
}
.card-actions{
  @apply(--layout-horizontal);
  @apply(--layout-flex);
  /*align-items: center;*/
  background-color: #F2F9FF;
}
#edit{
  float: right;
}
@media only screen and (max-width: 375px) {
  .info{
    padding-left: 0;
    text-align: center;
    vertical-align: middle;
  }
}
</style>
<template>
  <firebase-auth user="{{user}}"></firebase-auth>
  <firebase-query
    id="staged"
    limit-to-first={{limitToFirst}}
    order-by-child="order"
    path="/staged/tweets"
    data={{staged}}>
  </firebase-query>
  <firebase-query
    id="queue"
    path="/queue"
    data={{queued}}>
  </firebase-query>
  <firebase-query
    id="tweeted"
    path="/tweeted/tweets"
    data={{tweeted}}>
  </firebase-query>
<!-- <div id="card"> -->
  <div id="tweets" class="layout vertical">
    <div class="list-container">
    <paper-card id="name" class="pcard">
      <!-- <div class="card-content"> -->
        <!-- <div class="list-container"> -->
          <div class="tweet-text" id="name"><h1>Tweets in Queue</h1></div>
        <!-- </div> -->
      <!-- </div> -->
    </paper-card>
    </div>
    <template is="dom-repeat" items="[[staged]]" as="tweet">
      <div class="list-container">
        <paper-card id="[[tweet.time]]" class="pcard">
          <div class="card-content">
            <div class="container, layout horizontal">
              <div class="userpic-container">
                <img class="userpic" src=[[tweet.photoURL]] width="64px" height="64px"/>
              </div>
              <div class="tweet-text">[[tweet.text]]</div>
            </div>
          </div>
          <div class="card-actions" id="userinfo">

          <paper-dialog id="animated" entry-animation="scale-up-animation" exit-animation="fade-out-animation" with-backdrop>
            <h2>Edit Tweet [[tweet.$id]]</h2>
            <p>[[tweet.text]]</p>
            </paper-dialog>
            <div class="info">
              <div class="info-details" style="text-align: left;">
                Status:
                <template is="dom-if" if="[[admin.email]]"  restamp="true">
                You are admin!
                </template>
                <template is="dom-if" if="[[tweet.posted]]" restamp="true">
                Posted
                </template>
                <template is="dom-if" if="[[tweet.queued]]" restamp="true">
                In The Queue
                </template>
                <template is="dom-if" if="[[!tweet.valid]]" restamp="true">
                Waiting
                </template>
              </div>
              <div class="info-details">
              Author: [[tweet.author]]
              </div>
              <!-- <div class="info-details">
              Last Edit: [[tweet.lastEdit]]
              </div> -->

            </div>
            <!-- <paper-button disabled id="edit" key="[[textUpdateInput]]"
              tweet=[[tweet]] on-tap="animated.open()">
              Edit
            </paper-button> -->
            </div>
          </paper-card>

        <!-- </div> -->
        <!-- </div> -->
      </div>
  </template>
  <paper-card class="list-container">
    <div class="card-actions">
      <paper-button raised class="card-actions" id="load-more" on-tap="loadmore">
        Load More
      </paper-button>
    </div>
  </paper-card>
</div>
<!-- </div> -->
</template>
<script>
Polymer({
  is: 'tweets-list',
  properties: {
    staged: {
      type: Object,
      limitToFirst: 5
    },
    queued: {
      type: Object
    },
    tweeted: {
      type: Object
    },
    user:{
      type: Object
    },
    show: {
      type: Boolean,
      value: false
    },
    admin:{
      type: Boolean,
      value: false
    },
    up: function() {
      console.log(user);
    },
    limitToFirst:{
      type: Number,
      value: 5
    }
  },
  loadmore(){
    this.limitToFirst += 5;
  },
  // ready: function() {
  // this.admin = new Boolean(this.user.email == "nerveclasp@gmail.com");
  // console.log(this);
  // },
  edit: function(e){
    var key = e.currentTarget.tweet.$key;
    console.log(e.currentTarget.key);
    // this.$.query.ref.child(key).update({
    //   text: this.$[key].value
    // })
  },
  update: function() {
    this.$.staged.ref.push({
      text: this.$.textedit.value,
      valid: true,
      posted: false
    });
    // this.$.input.value = null;
  }
});
</script>
</dom-module>
